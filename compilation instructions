You need to download FSL from source (no need to install) and add the follow to your .bash_profile

export FSLDIR=<path to your extracted fsl>
. ${FSLDIR}/etc/fslconf/fsl.sh

You also need to add 

export FSLDEVDIR=<folder where includes and libraries will go>

Then create $FSLDEVDIR and associated folders:
mkdir -p  $FSLDEVDIR  $FSLDEVDIR/extras $FSLDEVDIR/extras/include $FSLDEVDIR/extras/src

Copy/move the folder extras/ELC1.04/ELC from this repository to your $FSLDEVDIR as $FSLDEVDIR/extras/include/ELC
Copy $FSLDIR/src/FastPDlib to $FSLDEVDIR/extras/src

Then compile (make install) each repository directory in order (note you require c++11 support):

newmesh
DiscreteOpt
FastPDlib (from $FSLDEVDIR/extras/src)
MSMRegLib
MSM

Binaries will be deposited in the MSM folder

# Build in docker for the struct pipeline

Start the struct pipeline docker with:

	docker run --rm -it --entrypoint /bin/bash \
		biomedia/dhcp-structural-pipeline:emma

Then:

	. /etc/fsl/fsl.sh 
	edit ${FSLDIR}/etc/fslconf/fsl.sh and uncomment the lines for FSLCONFDIR FSLMACHTYPE
	. $FSLDIR/etc/fslconf/fsl.sh
	export FSLDEVDIR=$FSLDIR
	cd /usr/src
	git clone https://github.com/jcupitt/MSM_HOCR.git
	cd MSM_HOCR
	git checkout struct-pipeline-build
	cp -r extras/ELC1.04/ELC $FSLDEVDIR/extras/include/ELC
	cp -r $FSLDIR/src/FastPDlib $FSLDEVDIR/extras/src
	
	
	
	
	



